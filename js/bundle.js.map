{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","js/src/main.js","js/src/core/history.js","js/src/utils/ajaxRequest.js","js/src/utils/resizeCanvas.js","js/src/core/moduleFactory.js","js/src/modules/AnyLink.js","js/src/modules/NavLink.js","js/src/modules/WorkImage.js"],"names":["history","require","init","_win","addEventListener","onPopState","_maskEl","_doc","querySelector","_htmlEl","_contentEl","getContentEl","style","opacity","body","classList","add","moduleFactory","run","internalLoad","url","hidePage","ajaxRequest","response","contentEl","parserEl","createElement","innerHTML","_pendingClass","getAttribute","_pendingContent","showPage","parent","pushState","location","pathname","_isHiding","display","tweenMask","window","scrollTo","className","dest","callback","ease","Cubic","easeOut","easeIn","TweenLite","to","onComplete","resizeCanvas","document","exports","module","settings","request","XMLHttpRequest","method","open","responseType","onreadystatechange","readyState","status","console","error","params","setRequestHeader","length","send","getBackingStoreRatio","context","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","DEVICE_PIXEL_RATIO","devicePixelRatio","_backingStoreRatio","_canvasPixelRatio","getContext","canvasEl","width","height","oldWidth","oldHeight","scale","parentEl","destroyModules","_currentModules","createModules","i","destroy","_moduleConfigs","forEach","config","moduleEl","els","querySelectorAll","selector","constructor","contains","push","el","_el","_href","checkIsExternalUrl","onClick","e","preventDefault","removeEventListener","PATTERN_FOR_EXTERNAL_URLS","undefined","search","this","MOUSE_ENTER_EVENT","MOUSE_LEAVE_EVENT","addHover","onMouseOut","tweenTo","newX","remove","distance","currentHoverEl","tween","x","easeInOut","onUpdate","transform","removeChild","appendChild","_isAlive","_parent","_videoEl","_sizingEl","getElementsByClassName","_canvasEl","_context","_progress","p","_loadedCount","_imgUrl","_image","Image","src","loop","onload","onLoaded","killTweensOf","onMouseOver","onResize","play","pause","currentTime","redraw","drawImage","_canvasWidth","_canvasHeight","drawMask","requestAnimationFrame","progress","lineTo","y","firstHalfProgress","Math","min","secondHalfProgress","max","save","beginPath","moveTo","round","closePath","clip","restore","offsetWidth","offsetHeight"],"mappings":"AAAA;AEcA,QAASE,QAERC,KAAKC,iBAAiB,WAAYC,YAElCC,QAAUC,KAAKC,cAAc,SAC7BC,QAAUF,KAAKC,cAAc,QAC7BE,WAAaC,aAAaJ,MAC1BD,QAAQM,MAAMC,QAAU,EAExBN,KAAKO,KAAKC,UAAUC,IAAI,cACxBN,WAAWK,UAAUC,IAAI,cAEzBC,cAAcC,MAKf,QAASC,cAAaC,GAErBC,WAEAC,YAAYF,EAAK,SAASG,GAExB,GACCC,GADGC,EAAWlB,KAAKmB,cAAc,OAGlCD,GAASE,UAAYJ,EAErBC,EAAYb,aAAac,GAEzBG,cAAgBJ,EAAUK,aAAa,cACvCC,gBAAkBN,EAAUG,UAE5BI,aAIH,QAASpB,cAAaqB,GAErB,MAAOA,GAAOxB,cAAc,eAG7B,QAASyB,WAAUb,GAElBjB,KAAKH,QAAQiC,WACVb,IAAKA,GACP,GACAA,GAGDD,aAAaC,GAGd,QAASf,cAGRc,aAAahB,KAAK+B,SAASC,UAG5B,QAASd,YAERe,WAAY,EAEZ9B,QAAQM,MAAMyB,QAAU,QAExBC,UAAU,EAAG,WAEXF,WAAY,EACTN,kBAEFS,OAAOC,SAAS,EAAE,GAClB9B,WAAWiB,UAAYG,gBACvBrB,QAAQgC,UAAYb,cACpBE,iBAAkB,EAIlBC,cAMJ,QAASA,YAELK,WAKHE,UAAU,EAAG,WAEZhC,QAAQM,MAAMyB,QAAU,OACxBpB,cAAcC,IAAIR,cAIpB,QAAS4B,WAAUI,EAAMC,GAExB,GAAIC,EAIHA,GAFEF,EAAO,EAEFG,MAAMC,QAIND,MAAME,OAGdC,UAAUC,GAAG3C,QAAQM,MAAO,KAC3BC,QAAS6B,EACTE,KAAKA,EACLM,WAAY,WAEXP,OAjIH,GAAIrB,aAAcrB,QAAQ,wBACzBkD,aAAelD,QAAQ,yBACvBgB,cAAgBhB,QAAQ,mBAErBM,KAAO6C,SACVjD,KAAOoC,OACP9B,QACAC,WACAJ,QACAsB,eAAgB,EAChBE,iBAAkB,EAClBM,WAAY,CA2HbiB,SAAQnD,KAAOA,KACfmD,QAAQpB,UAAYA;;AGhIpB,QAASf,KAAIsE,GAERA,IAEHA,EAAWpC,UAGZqC,iBAEAC,mBAEAC,cAAcH,GAGf,QAASC,kBAER,GAAIG,EAEJ,KAAIA,EAAI,EAAGA,EAAIF,gBAAgBtB,OAAQwB,IAEtCF,gBAAgBE,GAAGC,UAIrB,QAASF,eAAcH,GAEtBM,eAAeC,QAAQ,SAASC,GAG/B,GACC1C,GACA2C,EACAL,EAHGM,EAAMV,EAASW,iBAAiBH,EAAOI,SAK3C,KAAIR,EAAI,EAAGA,EAAIM,EAAI9B,OAAQwB,IAE1BK,EAAWC,EAAIN,GAEftC,EAAS,GAAI0C,GAAOK,YAEpB/C,EAAOpD,KAAK+F,GAERA,EAASlF,UAAUuF,SAAS,oBAE/BZ,gBAAgBa,KAAKjD,KAnDzB,GAAIwC,iBACF7F,QAAQ,sBACRA,QAAQ,sBACRA,QAAQ,yBAETyF,kBAoDDrC,SAAQnC,IAAMA;;AJzDd,GAAIlB,SAAUC,QAAQ,iBAEtBD,SAAQE;;AKFR,GAAIF,SAAUC,QAAQ,kBAEtBoD,SAAQ+C,SAAW,IAEnB/C,QAAQgD,YAAc,WAKrB,QAASnG,GAAKsG,GAEbC,EAAMD,EACNE,EAAQF,EAAG3E,aAAa,QAEpB8E,EAAmBD,IAEtBD,EAAIrG,iBAAiB,QAASwG,GAIhC,QAASA,GAAQC,GAEhBA,EAAEC,iBAECJ,IAAUnE,OAAOL,SAASC,UAE5BnC,QAAQiC,UAAUyE,GAIpB,QAASb,KAERY,EAAIM,oBAAoB,QAASH,GAEjCF,EAAQ,KACRD,EAAM,KAIP,QAASE,GAAmBvF,GAE3B,GAAI4F,GAA4B,cAEhC,OAAeC,UAAR7F,GAA+D,KAA1CA,EAAI8F,OAAOF,GArCxC,GAAIN,GACHD,CAuCDU,MAAKjH,KAAOA,EACZiH,KAAKtB,QAAUA;;AC/ChB,GAAIuB,mBAAoB,aACvBC,kBAAoB,YAErBhE,SAAQ+C,SAAW,cAEnB/C,QAAQgD,YAAc,WAIrB,QAASnG,GAAKsG,GAEbC,EAAMD,EAENC,EAAIrG,iBAAiBgH,kBAAmBE,GAGzC,QAASA,KAeR,QAASC,GAAWV,GAEnBW,EAAQ,KAAK,GAEbf,EAAIrG,iBAAiBgH,kBAAmBE,GACxCb,EAAIM,oBAAoBM,kBAAmBE,GAG5C,QAASC,GAAQC,EAAMC,GAEtB,GAAIC,IAAYF,EAAOG,EAAeC,MAAMC,GAAK,GAEjD9E,WAAUC,GAAG2E,EAAeC,MAAO,IAAOF,GACzCG,EAAGL,EACH7E,KAAMC,MAAMkF,UACZC,SAAU,WAETJ,EAAehH,MAAMqH,UAAY,cAAgBL,EAAeC,MAAMC,EAAI,MAE3E5E,WAAY,WAEPwE,IAEHjB,EAAIyB,YAAYN,GAChBA,EAAiB,SArCrB,GAAIA,EAEJnB,GAAIM,oBAAoBK,kBAAmBE,GAE3CM,EAAiBxE,SAAS1B,cAAc,OACxCkG,EAAenF,UAAY,mBAC3BmF,EAAeC,OAASC,EAAG,MAE3BrB,EAAI0B,YAAYP,GAChBJ,EAAQ,GAERf,EAAIrG,iBAAiBiH,kBAAmBE,GAtBzC,GAAId,EAuDJU,MAAKjH,KAAOA;;AC9Db,GAAIiD,cAAelD,QAAQ,wBAE3BoD,SAAQ+C,SAAW,gBACnB/C,QAAQgD,YAAc,WAerB,QAASnG,GAAKsG,GAIb4B,GAAW,EACXC,EAAU7B,EACV8B,EAAWlF,SAAS1B,cAAc,SAClC6G,EAAY/B,EAAGgC,uBAAuB,sBAAsB,GAC5DC,EAAYjC,EAAGgC,uBAAuB,wBAAwB,GAC9DE,EAAWD,EAAUxD,WAAW,MAChC0D,GAAaC,EAAE,GACfC,EAAe,EACfC,EAAUL,EAAU5G,aAAa,YACjCkH,EAAS,GAAIC,OAEbV,EAASW,IAAOR,EAAU5G,aAAa,YACvCyG,EAASY,MAAM,EAEfH,EAAOI,OAASC,EAChBL,EAAOE,IAAMH,EAGd,QAASjD,KAERuC,GAAW,EACXW,EAAOI,OAAS,KAEhBb,EAAW,KACXtF,UAAUqG,aAAaV,GAEvBN,EAAQtB,oBAAoB,aAAcuC,GAC1CjB,EAAQtB,oBAAoB,aAAcQ,GAC1ChF,OAAOwE,oBAAoB,SAAUwC,GAGtC,QAASD,KAERhB,EAASkB,OAETxG,UAAUC,GAAG0F,EAAW,IACvBC,EAAE,EACFhG,KAAMC,MAAMkF,YAId,QAASR,KAERvE,UAAUC,GAAG0F,EAAW,IACvBC,EAAE,EACFhG,KAAMC,MAAMkF,UACZ7E,WAAW,WAEVoF,EAASmB,QACTnB,EAASoB,YAAc,KAM1B,QAASN,KAER7G,OAAOnC,iBAAiB,SAAUmJ,GAClCA,IAEAI,IAEAtB,EAAQjI,iBAAiB,aAAckJ,GACvCjB,EAAQjI,iBAAiB,aAAcmH,GAKxC,QAASoC,KAERjB,EAASkB,UAAUb,EAAQ,EAAG,EAAGc,EAAcC,GAE5CnB,EAAUC,EAAI,GAEhBmB,EAASpB,EAAUC,GAGjBR,GAEF4B,sBAAsBL,GAKxB,QAASI,GAASE,GAqCjB,QAASC,GAAOpC,EAAGqC,GAElBzB,EAASwB,OAAOpC,EAAGqC,GArCpB,GAAIC,GAAoBC,KAAKC,IAAI,EAAc,EAAXL,GACnCM,EAAqBF,KAAKG,IAAI,EAAsB,GAAlBP,EAAW,IAE9CvB,GAAS+B,OAET/B,EAASgC,YAGThC,EAASiC,OAAO,EAAGb,GAGnBI,EAAOG,KAAKO,MAAMf,EAAeO,GAAoBN,GAGlDS,IAEFL,EAAOL,EAAcQ,KAAKO,MAAMd,GAAiB,EAAIS,KACrDL,EAAOG,KAAKO,MAAMf,EAAeU,GAAqB,IAMvDL,EAAO,EAAGG,KAAKO,MAAMd,GAAiB,EAAIM,KAG1C1B,EAASmC,YAETnC,EAASoC,OAETpC,EAASkB,UAAUtB,EAAU,EAAG,EAAGuB,EAAcC,GAGjDpB,EAASqC,UAQV,QAASxB,KAERM,EAAetB,EAAUyC,YACzBlB,EAAgBvB,EAAU0C,aAE1B9H,aAAasF,EAAWoB,EAAcC,GArJvC,GAAIzB,GACHD,EACAE,EACAC,EACAE,EACAC,EACAC,EACAE,EACAgB,EACAC,EACAhB,EACAC,CA6ID5B,MAAKjH,KAAOA,EACZiH,KAAKtB,QAAUA;;AL9JhBvC,OAAOD,QAAU,SAASjC,EAAKuB,EAAUY,GAEnCA,IACJA,KAGD,IAAIC,GAAU,GAAIC,gBACjBC,EAASH,EAASG,QAAU,KAI7BF,GAAQG,KAAKD,EAAQtC,GAAK,GAEtBmC,EAASK,eACZJ,EAAQI,aAAeL,EAASK,cAGjCJ,EAAQK,mBAAqB,WAE5B,GAAItC,EAEuB,KAAvBiC,EAAQM,aAEY,MAAnBN,EAAQO,QAEXxC,EAAWiC,EAAQjC,SAEnBoB,EAASpB,IAITyC,QAAQC,MAAMT,KAKbD,EAASW,QACZV,EAAQW,iBAAiB,iBAAkBZ,EAASW,OAAOE,QAG5DZ,EAAQa,KAAKd,EAASW;;AChCvB,QAASI,sBAAqBC,GAE7B,MAAOA,GAAQC,8BACdD,EAAQE,2BACRF,EAAQG,0BACRH,EAAQI,yBACRJ,EAAQK,wBAA0B,EAdpC,GAAIC,oBAAqBtC,OAAOuC,kBAAoB,EACnDC,mBACAC,kBACAT,QAAUnB,SAAS1B,cAAc,UAAUuD,WAAW,KAEvDF,oBAAqBT,qBAAqBC,SAC1CS,kBAAoBH,mBAAqBE,mBAWzCzB,OAAOD,QAAU,SAAS6B,EAAUC,EAAOC,GAE1C,GAAIC,GACHC,EACAf,EAAUW,EAASD,WAAW,KAE/BC,GAASC,MAAQA,EACjBD,EAASE,OAASA,EAEfP,qBAAuBE,qBAEzBM,EAAWH,EAASC,MACpBG,EAAYJ,EAASE,OAErBF,EAASC,MAAQE,EAAWL,kBAC5BE,EAASE,OAASE,EAAYN,kBAE9BE,EAAStE,MAAMuE,MAAQE,EAAW,KAClCH,EAAStE,MAAMwE,OAASE,EAAY,KAEpCf,EAAQgB,MAAMP,kBAAmBA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var history = require('./core/history');\n\nhistory.init();\n\n","var ajaxRequest = require('../utils/ajaxRequest'),\n\tresizeCanvas = require('../utils/resizeCanvas'),\n\tmoduleFactory = require('./moduleFactory');\n\nvar _doc = document,\n\t_win = window,\n\t_htmlEl,\n\t_contentEl,\n\t_maskEl,\n\t_pendingClass = false,\n\t_pendingContent = false,\n\t_isHiding = false;\n\n\nfunction init() {\n\n\t_win.addEventListener('popstate', onPopState);\n\n\t_maskEl = _doc.querySelector('.mask');\n\t_htmlEl = _doc.querySelector('html');\n\t_contentEl = getContentEl(_doc);\n\t_maskEl.style.opacity = 0;\n\n\t_doc.body.classList.add('is-visible');\n\t_contentEl.classList.add('is-visible');\n\n\tmoduleFactory.run();\n}\n\n\n\nfunction internalLoad(url) {\n\n\thidePage();\n\n\tajaxRequest(url, function(response){\n\n\t\t\tvar parserEl = _doc.createElement('html'),\n\t\t\t\tcontentEl;\n\n\t\t\tparserEl.innerHTML = response;\n\n\t\t\tcontentEl = getContentEl(parserEl);\n\n\t\t\t_pendingClass = contentEl.getAttribute('data-class');\n\t\t\t_pendingContent = contentEl.innerHTML;\n\n\t\t\tshowPage();\n\t\t});\n}\n\nfunction getContentEl(parent) {\n\n\treturn parent.querySelector('.js-content');\n}\n\nfunction pushState(url) {\n\n\t_win.history.pushState(\n\t\t{ url: url },\n\t\t'',\n\t\turl\n\t);\n\n\tinternalLoad(url);\n}\n\nfunction onPopState() {\n\n\n\tinternalLoad(_win.location.pathname);\n}\n\nfunction hidePage() {\n\n\t_isHiding = true;\n\n\t_maskEl.style.display = 'block';\n\n\ttweenMask(1, function() {\n\n\t\t\t_isHiding = false;\n\t\t\tif(_pendingContent) {\n\n\t\t\t\twindow.scrollTo(0,0);\n\t\t\t\t_contentEl.innerHTML = _pendingContent;\n\t\t\t\t_htmlEl.className = _pendingClass;\n\t\t\t\t_pendingContent = false;\n\t\t\t\t//setupPage();\n\n\n\t\t\t\tshowPage();\n\t\t\t}\n\t\t}\n\t)\n}\n\nfunction showPage() {\n\n\tif(_isHiding) {\n\n\t\treturn;\n\t}\n\n\ttweenMask(0, function(){\n\n\t\t_maskEl.style.display = 'none';\n\t\tmoduleFactory.run(_contentEl);\n\t});\n}\n\nfunction tweenMask(dest, callback) {\n\n\tvar ease;\n\n\tif(dest > 0) {\n\n\t\tease = Cubic.easeOut;\n\n\t} else {\n\n\t\tease = Cubic.easeIn;\n\t}\n\n\tTweenLite.to(_maskEl.style, 0.25, {\n\t\topacity: dest,\n\t\tease:ease,\n\t\tonComplete: function(){\n\n\t\t\tcallback();\n\t\t}\n\t});\n}\n\nexports.init = init;\nexports.pushState = pushState;","module.exports = function(url, callback, settings) {\n\n\tif (!settings) {\n\t\tsettings = {};\n\t}\n\n\tvar request = new XMLHttpRequest(),\n\t\tmethod = settings.method || 'GET';\n\n\n\t// needs to be open before responseType is set\n\trequest.open(method, url, true);\n\n\tif (settings.responseType) {\n\t\trequest.responseType = settings.responseType;\n\t}\n\n\trequest.onreadystatechange = function() {\n\n\t\tvar response;\n\n\t\tif (request.readyState === 4) {\n\n\t\t\tif (request.status === 200) {\n\n\t\t\t\tresponse = request.response;\n\n\t\t\t\tcallback(response);\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error(request);\n\t\t\t}\n\t\t}\n\t};\n\n\tif (settings.params) {\n\t\trequest.setRequestHeader('Content-length', settings.params.length);\n\t}\n\n\trequest.send(settings.params);\n};\n","var DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1,\n\t_backingStoreRatio,\n\t_canvasPixelRatio,\n\tcontext = document.createElement('canvas').getContext('2d');\n\n_backingStoreRatio = getBackingStoreRatio(context);\n_canvasPixelRatio = DEVICE_PIXEL_RATIO / _backingStoreRatio;\n\nfunction getBackingStoreRatio(context) {// eslint-disable-line\n\n\treturn context.webkitBackingStorePixelRatio ||\n\t\tcontext.mozBackingStorePixelRatio ||\n\t\tcontext.msBackingStorePixelRatio ||\n\t\tcontext.oBackingStorePixelRatio ||\n\t\tcontext.backingStorePixelRatio || 1;\n}\n\nmodule.exports = function(canvasEl, width, height) {\n\n\tvar oldWidth,\n\t\toldHeight,\n\t\tcontext = canvasEl.getContext('2d');\n\n\tcanvasEl.width = width;\n\tcanvasEl.height = height;\n\n\tif(DEVICE_PIXEL_RATIO !== _backingStoreRatio) {\n\n\t\toldWidth = canvasEl.width;\n\t\toldHeight = canvasEl.height;\n\n\t\tcanvasEl.width = oldWidth * _canvasPixelRatio;\n\t\tcanvasEl.height = oldHeight * _canvasPixelRatio;\n\n\t\tcanvasEl.style.width = oldWidth + 'px';\n\t\tcanvasEl.style.height = oldHeight + 'px';\n\n\t\tcontext.scale(_canvasPixelRatio, _canvasPixelRatio);\n\t}\n};","var _moduleConfigs = [\n\t\trequire('../modules/AnyLink'),\n\t\trequire('../modules/NavLink'),\n\t\trequire('../modules/WorkImage')\n\t],\n\t_currentModules = [];\n\nfunction run(parentEl) {\n\n\tif(!parentEl) {\n\n\t\tparentEl = document;\n\t}\n\n\tdestroyModules();\n\n\t_currentModules = [];\n\n\tcreateModules(parentEl);\n}\n\nfunction destroyModules() {\n\n\tvar i;\n\n\tfor(i = 0; i < _currentModules.length; i++) {\n\n\t\t_currentModules[i].destroy();\n\t}\n}\n\nfunction createModules(parentEl) {\n\n\t_moduleConfigs.forEach(function(config){\n\n\n\t\tvar els = parentEl.querySelectorAll(config.selector),\n\t\t\tmodule,\n\t\t\tmoduleEl,\n\t\t\ti;\n\n\t\tfor(i = 0; i < els.length; i++) {\n\n\t\t\tmoduleEl = els[i];\n\n\t\t\tmodule = new config.constructor();\n\n\t\t\tmodule.init(moduleEl);\n\n\t\t\tif(!moduleEl.classList.contains('js-moduleIgnore')) {\n\n\t\t\t\t_currentModules.push(module);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexports.run = run;","var history = require('../core/history');\n\nexports.selector = 'a';\n\nexports.constructor = function() {\n\n\tvar _href,\n\t\t_el;\n\n\tfunction init(el) {\n\n\t\t_el = el;\n\t\t_href = el.getAttribute('href');\n\n\t\tif(!checkIsExternalUrl(_href)) {\n\n\t\t\t_el.addEventListener('click', onClick);\n\t\t}\n\t}\n\n\tfunction onClick(e) {\n\n\t\te.preventDefault();\n\n\t\tif(_href !== window.location.pathname) {\n\n\t\t\thistory.pushState(_href);\n\t\t}\n\t}\n\n\tfunction destroy() {\n\n\t\t_el.removeEventListener('click', onClick);\n\n\t\t_href = null;\n\t\t_el = null;\n\t}\n\n\n\tfunction checkIsExternalUrl(url) {\n\n\t\tvar PATTERN_FOR_EXTERNAL_URLS = /^(\\w+:)?\\/\\//;\n\n\t\treturn url !== undefined && url.search(PATTERN_FOR_EXTERNAL_URLS) !== -1;\n\t}\n\n\tthis.init = init;\n\tthis.destroy = destroy;\n};","var MOUSE_ENTER_EVENT = 'mouseenter',\n\tMOUSE_LEAVE_EVENT = 'mouseleave';\n\nexports.selector = '.js-navLink';\n\nexports.constructor = function() {\n\n\tvar _el;\n\n\tfunction init(el) {\n\n\t\t_el = el;\n\n\t\t_el.addEventListener(MOUSE_ENTER_EVENT, addHover);\n\t}\n\n\tfunction addHover() {\n\n\t\tvar currentHoverEl;\n\n\t\t_el.removeEventListener(MOUSE_ENTER_EVENT, addHover);\n\n\t\tcurrentHoverEl = document.createElement('div');\n\t\tcurrentHoverEl.className = 'nav__link__hover';\n\t\tcurrentHoverEl.tween = {x: -100};\n\n\t\t_el.appendChild(currentHoverEl);\n\t\ttweenTo(0);\n\n\t\t_el.addEventListener(MOUSE_LEAVE_EVENT, onMouseOut);\n\n\t\tfunction onMouseOut(e) {\n\n\t\t\ttweenTo(100, true);\n\n\t\t\t_el.addEventListener(MOUSE_ENTER_EVENT, addHover);\n\t\t\t_el.removeEventListener(MOUSE_LEAVE_EVENT, onMouseOut);\n\t\t}\n\n\t\tfunction tweenTo(newX, remove) {\n\n\t\t\tvar distance = (newX - currentHoverEl.tween.x) / 100;\n\n\t\t\tTweenLite.to(currentHoverEl.tween, 0.35 * distance, {\n\t\t\t\tx: newX,\n\t\t\t\tease: Cubic.easeInOut,\n\t\t\t\tonUpdate: function() {\n\n\t\t\t\t\tcurrentHoverEl.style.transform = 'translateX(' + currentHoverEl.tween.x + '%)';\n\t\t\t\t},\n\t\t\t\tonComplete: function() {\n\n\t\t\t\t\tif (remove) {\n\n\t\t\t\t\t\t_el.removeChild(currentHoverEl);\n\t\t\t\t\t\tcurrentHoverEl = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tthis.init = init;\n};","var resizeCanvas = require('../utils/resizeCanvas');\n\nexports.selector = '.js-workImage';\nexports.constructor = function() {\n\n\tvar _parent,\n\t\t_isAlive,\n\t\t_videoEl,\n\t\t_sizingEl,\n\t\t_canvasEl,\n\t\t_context,\n\t\t_progress,\n\t\t_loadedCount,\n\t\t_canvasWidth,\n\t\t_canvasHeight,\n\t\t_imgUrl,\n\t\t_image;\n\n\tfunction init(el) {\n\n\t\tvar videoSrc;\n\n\t\t_isAlive = true;\n\t\t_parent = el;\n\t\t_videoEl = document.createElement('video');\n\t\t_sizingEl = el.getElementsByClassName('js-workImage__size')[0];\n\t\t_canvasEl = el.getElementsByClassName('js-workImage__canvas')[0];\n\t\t_context = _canvasEl.getContext('2d');\n\t\t_progress = {p:0};\n\t\t_loadedCount = 0;\n\t\t_imgUrl = _canvasEl.getAttribute('data-jpg');\n\t\t_image = new Image();\n\n\t\t_videoEl.src =  _canvasEl.getAttribute('data-mp4');\n\t\t_videoEl.loop= true;\n\n\t\t_image.onload = onLoaded;\n\t\t_image.src = _imgUrl;\n\t}\n\n\tfunction destroy() {\n\n\t\t_isAlive = false;\n\t\t_image.onload = null;\n\n\t\t_videoEl = null;\n\t\tTweenLite.killTweensOf(_progress);\n\n\t\t_parent.removeEventListener('mouseenter', onMouseOver);\n\t\t_parent.removeEventListener('mouseleave', onMouseOut);\n\t\twindow.removeEventListener('resize', onResize);\n\t}\n\n\tfunction onMouseOver() {\n\n\t\t_videoEl.play();\n\n\t\tTweenLite.to(_progress, 0.5, {\n\t\t\tp:1,\n\t\t\tease: Cubic.easeInOut\n\t\t})\n\t}\n\n\tfunction onMouseOut() {\n\n\t\tTweenLite.to(_progress, 0.5, {\n\t\t\tp:0,\n\t\t\tease: Cubic.easeInOut,\n\t\t\tonComplete:function(){\n\n\t\t\t\t_videoEl.pause();\n\t\t\t\t_videoEl.currentTime = 0;\n\t\t\t}\n\t\t})\n\t}\n\n\n\tfunction onLoaded() {\n\n\t\twindow.addEventListener('resize', onResize);\n\t\tonResize();\n\n\t\tredraw();\n\n\t\t_parent.addEventListener('mouseenter', onMouseOver);\n\t\t_parent.addEventListener('mouseleave', onMouseOut);\n\t}\n\n\n\n\tfunction redraw() {\n\n\t\t_context.drawImage(_image, 0, 0, _canvasWidth, _canvasHeight);\n\n\t\tif(_progress.p > 0) {\n\n\t\t\tdrawMask(_progress.p);\n\t\t}\n\n\t\tif(_isAlive) {\n\n\t\t\trequestAnimationFrame(redraw);\n\t\t}\n\t}\n\n\n\tfunction drawMask(progress) {\n\n\t\tvar firstHalfProgress = Math.min(1, progress * 2),\n\t\t\tsecondHalfProgress = Math.max(0, (progress - 0.5) * 2);\n\n\t\t_context.save();\n\n\t\t_context.beginPath();\n\n\t\t// start at bottom left\n\t\t_context.moveTo(0, _canvasHeight);\n\n\t\t// absolute line to bottom right, based on firstHalfProgress\n\t\tlineTo(Math.round(_canvasWidth * firstHalfProgress), _canvasHeight);\n\n\t\t// if we passed the first half, we draw two additional lines trying to fill up the screen\n\t\tif(secondHalfProgress) {\n\n\t\t\tlineTo(_canvasWidth, Math.round(_canvasHeight * (1 - secondHalfProgress)));\n\t\t\tlineTo(Math.round(_canvasWidth * secondHalfProgress), 0);\n\t\t}\n\n\n\n\t\t// absolute line back to top left, based on firstHalfProgress\n\t\tlineTo(0, Math.round(_canvasHeight * (1 - firstHalfProgress)));\n\n\t\t// close up our path\n\t\t_context.closePath();\n\n\t\t_context.clip();\n\n\t\t_context.drawImage(_videoEl, 0, 0, _canvasWidth, _canvasHeight);\n\n\n\t\t_context.restore();\n\n\t\tfunction lineTo(x, y) {\n\n\t\t\t_context.lineTo(x, y);\n\t\t}\n\t}\n\n\tfunction onResize() {\n\n\t\t_canvasWidth = _sizingEl.offsetWidth;\n\t\t_canvasHeight = _sizingEl.offsetHeight;\n\n\t\tresizeCanvas(_canvasEl, _canvasWidth, _canvasHeight);\n\t}\n\n\tthis.init = init;\n\tthis.destroy = destroy;\n};"]}