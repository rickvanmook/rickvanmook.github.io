(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function init(){_win.addEventListener("popstate",onPopState),_maskEl=_doc.querySelector(".mask"),_htmlEl=_doc.querySelector("html"),_contentEl=getContentEl(_doc),_maskEl.style.opacity=0,_doc.body.classList.add("is-visible"),_contentEl.classList.add("is-visible"),moduleFactory.run()}function internalLoad(e){signals.HISTORY_CHANGED.dispatch(e),ga&&ga("send",{hitType:"pageview",page:location.pathname}),_isHiding||hidePage(),ajaxRequest(e,function(e){var n,t=_doc.createElement("html");t.innerHTML=e,n=getContentEl(t),_pendingClass=n.getAttribute("data-class"),_pendingContent=n.innerHTML,_isHiding||setupPage()})}function getContentEl(e){return e.querySelector(".js-content")}function pushState(e){_win.history.pushState({url:e},"",e),internalLoad(e)}function onPopState(){internalLoad(_win.location.pathname)}function hidePage(){_isHiding=!0,_maskEl.style.display="block",tweenMask(1,function(){_isHiding=!1,_pendingContent&&setupPage()})}function setupPage(){_pendingContent&&(window.scrollTo(0,0),_contentEl.innerHTML=_pendingContent,_htmlEl.className=_pendingClass,_pendingContent=!1,showPage())}function showPage(){_isHiding||tweenMask(0,function(){_maskEl.style.display="none",TweenLite.delayedCall(.15,function(){moduleFactory.run(_contentEl)})})}function tweenMask(e,n){var t;t=e>0?Cubic.easeOut:Cubic.easeIn,TweenLite.to(_maskEl.style,.25,{opacity:e,ease:t,onComplete:function(){n()}})}var ajaxRequest=require("../utils/ajaxRequest"),resizeCanvas=require("../utils/resizeCanvas"),signals=require("./signals"),moduleFactory=require("./moduleFactory"),_doc=document,_win=window,_htmlEl,_contentEl,_maskEl,_shouldShow=!1,_pendingClass=!1,_pendingContent=!1,_isHiding=!1;exports.init=init,exports.pushState=pushState;
},{"../utils/ajaxRequest":10,"../utils/resizeCanvas":11,"./moduleFactory":2,"./signals":3}],2:[function(require,module,exports){
function run(e){e||(e=document),destroyModules(),_currentModules=[],createModules(e)}function destroyModules(){var e;for(e=0;e<_currentModules.length;e++)_currentModules[e].destroy()}function createModules(e){_moduleConfigs.forEach(function(r){var o,u,n,s=e.querySelectorAll(r.selector);for(n=0;n<s.length;n++)u=s[n],o=new r.constructor,o.init(u),u.classList.contains("js-moduleIgnore")||_currentModules.push(o)})}var _moduleConfigs=[require("../modules/Analytics"),require("../modules/AnyLink"),require("../modules/NavLink"),require("../modules/Card")],_currentModules=[];exports.run=run;
},{"../modules/Analytics":6,"../modules/AnyLink":7,"../modules/Card":8,"../modules/NavLink":9}],3:[function(require,module,exports){
var Signal=require("../libs/signals"),resized=new Signal,scrolled=new Signal;window.addEventListener("resize",resized.dispatch),document.addEventListener("scroll",scrolled.dispatch),exports.HISTORY_CHANGED=new Signal,exports.RESIZED=resized,exports.SCROLLED=scrolled;
},{"../libs/signals":4}],4:[function(require,module,exports){
!function(i){function t(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}function n(i,t){if("function"!=typeof i)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function e(){this._bindings=[],this._prevParams=null;var i=this;this.dispatch=function(){e.prototype.dispatch.apply(i,arguments)}}t.prototype={active:!0,params:null,execute:function(i){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(i):i,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},e.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,n,e,s){var r,o=this._indexOfListener(i,e);if(-1!==o){if(r=this._bindings[o],r.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t(this,i,n,e,s),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(i){var t=this._bindings.length;do--t;while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i,t){for(var n,e=this._bindings.length;e--;)if(n=this._bindings[e],n._listener===i&&n.context===t)return e;return-1},has:function(i,t){return-1!==this._indexOfListener(i,t)},add:function(i,t,e){return n(i,"add"),this._registerListener(i,!1,t,e)},addOnce:function(i,t,e){return n(i,"addOnce"),this._registerListener(i,!0,t,e)},remove:function(i,t){n(i,"remove");var e=this._indexOfListener(i,t);return-1!==e&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(i){if(this.active){var t,n=Array.prototype.slice.call(arguments),e=this._bindings.length;if(this.memorize&&(this._prevParams=n),e){t=this._bindings.slice(),this._shouldPropagate=!0;do e--;while(t[e]&&this._shouldPropagate&&t[e].execute(n)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=e;s.Signal=e,"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:i.signals=s}(this);
},{}],5:[function(require,module,exports){
var history=require("./core/history");history.init();
},{"./core/history":1}],6:[function(require,module,exports){
var history=require("../core/history");exports.selector=".js-analytics",exports.constructor=function(){function t(t){i=t,r=i.getAttribute("data-category"),c=i.getAttribute("data-label"),ga&&i.addEventListener("click",e)}function e(){ga("send","event",r,"click",c)}function n(){i.removeEventListener("click",e),c=null,r=null,i=null}var i,r,c;this.init=t,this.destroy=n};
},{"../core/history":1}],7:[function(require,module,exports){
var history=require("../core/history");exports.selector="a",exports.constructor=function(){function t(t){o=t,i=t.getAttribute("href"),n(i)||o.addEventListener("click",e)}function e(t){t.metaKey||t.ctrlKey||(t.preventDefault(),i!==window.location.pathname&&history.pushState(i))}function r(){o.removeEventListener("click",e),i=null,o=null}function n(t){var e=/^(\w+:)?\/\//;return void 0!==t&&-1!==t.search(e)}var i,o;this.init=t,this.destroy=r};
},{"../core/history":1}],8:[function(require,module,exports){
var resizeCanvas=require("../utils/resizeCanvas"),signals=require("../core/signals"),CLASS_IS_VISIBLE="is-visible",COUNTER=0;exports.selector=".js-card",exports.constructor=function(){function e(e){v=e,h=e.getElementsByClassName("js-card__size")[0],C=e.getElementsByClassName("js-card__canvas")[0],R=e.getElementsByClassName("js-card__image")[0],O=e.getElementsByClassName("js-card__cover")[0],p=C.getContext("2d"),S={p:0},w=0,L=C.getAttribute("data-mp4"),T=R.getAttribute("data-src"),B=O.getAttribute("data-src"),f=!1,I=window.innerHeight,signals.SCROLLED.add(t),signals.RESIZED.add(m),m(),t()}function t(){var e=window.pageYOffset||document.scrollTop||0,t=v.getBoundingClientRect().top+e;I+e>t&&t+_>e&&a()}function n(){g=!1,E=null,TweenLite.killTweensOf(S),v.removeEventListener("mouseenter",s),v.removeEventListener("mouseleave",i),v.removeEventListener("mouseenter",s),v.removeEventListener("mouseleave",i),signals.SCROLLED.remove(t)}function s(){E||c(),g=!0,d(),E.play(),TweenLite.to(S,.5,{p:1,ease:Cubic.easeInOut})}function i(){TweenLite.to(S,.5,{p:0,ease:Cubic.easeInOut,onComplete:function(){E.pause(),E.currentTime=0,g=!1}})}function a(){f=!0,v.classList.add(CLASS_IS_VISIBLE),u(),d(),v.addEventListener("touchstart",r),v.addEventListener("touchend",o),v.addEventListener("mouseenter",s),v.addEventListener("mouseleave",i),signals.SCROLLED.remove(t)}function r(){v.removeEventListener("mouseenter",s),v.removeEventListener("mouseleave",i)}function o(){v.addEventListener("mouseenter",s),v.addEventListener("mouseleave",i)}function u(){function e(){R.classList.add(CLASS_IS_VISIBLE)}R.onload=e,R.src=T}function c(){E=document.createElement("video"),E.loop=!0,E.src=L,O.src=B}function d(){p.clearRect(0,0,b,A),S.p>0&&l(S.p),g&&requestAnimationFrame(d)}function l(e){function t(e,t){p.lineTo(e,t)}var n=Math.min(1,2*e),s=Math.max(0,2*(e-.5));p.save(),p.beginPath(),p.moveTo(0,A),t(Math.round(b*n),A),s&&(t(b,Math.round(A*(1-s))),t(Math.round(b*s),0)),t(0,Math.round(A*(1-n))),p.closePath(),p.clip(),p.drawImage(O,0,0,b,A),p.drawImage(E,0,0,b,A),p.restore()}function m(){I=window.innerHeight,b=h.offsetWidth,A=h.offsetHeight,R.setAttribute("width",b),R.setAttribute("height",A),O.setAttribute("width",b),O.setAttribute("height",A),_=v.offsetHeight,resizeCanvas(C,b,A),g||d(),f||t()}var v,L,g,f,E,h,C,p,S,w,I,_,b,A,T,B,O,R;this.init=e,this.destroy=n};
},{"../core/signals":3,"../utils/resizeCanvas":11}],9:[function(require,module,exports){
var signals=require("../core/signals"),MOUSE_ENTER_EVENT="mouseenter",MOUSE_LEAVE_EVENT="mouseleave";exports.selector=".js-navLink",exports.constructor=function(){function e(e){s=e,s.addEventListener("touchstart",t),s.addEventListener("touchend",n),s.addEventListener(MOUSE_ENTER_EVENT,i),a=r(s.getAttribute("href")),signals.HISTORY_CHANGED.add(E)}function t(){s.removeEventListener(MOUSE_ENTER_EVENT,i)}function n(){s.addEventListener(MOUSE_ENTER_EVENT,i)}function E(){var e=r(window.location.pathname);e===a?s.classList.add("is-active"):s.classList.remove("is-active")}function i(){function e(n){t(100,!0),s.addEventListener(MOUSE_ENTER_EVENT,i),s.removeEventListener(MOUSE_LEAVE_EVENT,e)}function t(e,t){var E=(e-n.tween.x)/100;TweenLite.to(n.tween,.35*E,{x:e,ease:Cubic.easeInOut,onUpdate:function(){var e="translateX("+n.tween.x+"%)";n.style.msProperty=e,n.style.webkitTransform=e,n.style.transform=e},onComplete:function(){t&&(s.removeChild(n),n=null)}})}var n;s.removeEventListener(MOUSE_ENTER_EVENT,i),n=document.createElement("div"),n.className="nav__link__hover",n.tween={x:-100},s.appendChild(n),t(0),s.addEventListener(MOUSE_LEAVE_EVENT,e)}function r(e){return e.replace(/\//g,"")}var s,a;this.init=e};
},{"../core/signals":3}],10:[function(require,module,exports){
module.exports=function(e,s,t){t||(t={});var n=new XMLHttpRequest,r=t.method||"GET";n.open(r,e,!0),t.responseType&&(n.responseType=t.responseType),n.onreadystatechange=function(){var e;4===n.readyState&&(200===n.status?(e=n.response,s(e)):console.error(n))},t.params&&n.setRequestHeader("Content-length",t.params.length),n.send(t.params)};
},{}],11:[function(require,module,exports){
function getBackingStoreRatio(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1}var DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,_backingStoreRatio,_canvasPixelRatio,context=document.createElement("canvas").getContext("2d");_backingStoreRatio=getBackingStoreRatio(context),_canvasPixelRatio=DEVICE_PIXEL_RATIO/_backingStoreRatio,module.exports=function(t,i,e){var a,o,n=t.getContext("2d");t.width=i,t.height=e,DEVICE_PIXEL_RATIO!==_backingStoreRatio&&(a=t.width,o=t.height,t.width=a*_canvasPixelRatio,t.height=o*_canvasPixelRatio,t.style.width=a+"px",t.style.height=o+"px",n.scale(_canvasPixelRatio,_canvasPixelRatio))};
},{}]},{},[5])


//# sourceMappingURL=bundle.js.map