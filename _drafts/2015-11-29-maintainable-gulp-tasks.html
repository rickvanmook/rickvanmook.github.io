---
layout: post
title: Maintainable Gulp tasks
date: 2015-11-29 19:33:08
categories: writing
number: "XX"
---

<p>
Like every front-end dev, I've been working on a lot of automated build projects. Either with Grunt, Gulp or whatever.
</p>
<p>
With each project the main `gulpfile.js` tends to get a bit of a mess. It gets bloated with tasks, comments and becomes unreadable for whoever opens the file.
</p>
<p>
After a couple of projects dealing with it, I decided to hop on Google and search for some better ways to handle this.
</p>
<p>
    Turns out, a lot of people had similar problems and they found some pretty neat solutions for it. I took the one I liked the most and made a few little adjustments to it. Here's how my new setup looks:
</p>

<img src="/assets/">
<p>
    Rather than manage one giant configuration file responsible for creating multiple tasks, each task has been broken out into its own file in `gulp/tasks`. Any file in that folder gets automatically required by the loop in `./gulp/index.js.`
</p>
</div>
{% highlight javascript %}


var fs = require('fs'),

    // util to filter all none *.js files to prevent
    // accidental inclusion of possible hidden files
    onlyScripts = require('./util/scriptFilter'),
    getTaskNameByFile = require('./util/getTaskNameByFile'),

    tasksFiles = fs.readdirSync('./gulp/tasks/').filter(onlyScripts);

tasksFiles.forEach(function(taskFile) {

    // basically just gets the filename
    var taskName = getTaskNameByFile(taskFile),
        taskModule = require('./tasks/' + taskFile);

    // each module expects a taskName so it can assign
    // itself to the gulp task list
    taskModule(taskName);
});
{% endhighlight %}
<div class="post__content">
<p>
    The bare minimum code a task in the gulp folder needs looks something like this:
</p>
</div>
{% highlight javascript %}
var gulp = require('gulp');

module.exports = function(taskName) {

    gulp.task(taskName, function(){ ... });
};
{% endhighlight %}
<div class="post__content">
<p>
What I like the most is a clear overview of what tasks are available just by looking at the folder structure. It's better then scrolling through this one huge file and reading all the comments to figure out how something works.'
</p>